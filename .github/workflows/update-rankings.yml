name: Update Tennis Rankings (Fixed)

on:
  schedule:
    - cron: '0 9 * * 1'  # Segunda às 6h Brasília
  workflow_dispatch:

jobs:
  update-rankings:
    runs-on: ubuntu-latest
    timeout-minutes: 3  # Máximo 3 minutos
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Create current rankings (500 players)
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        echo "📊 Atualizando rankings com TOP 250 ATP + TOP 250 WTA..."
        
        # Remove arquivo antigo se existir
        rm -f current_rankings.json
        
        # Cria arquivo JSON com os rankings atuais 2025
        cat > current_rankings.json << 'EOF'
        {
          "atp_top_250": [
            "Jannik Sinner", "Carlos Alcaraz", "Alexander Zverev", "Jack Draper", "Lorenzo Musetti",
            "Novak Djokovic", "Casper Ruud", "Tommy Paul", "Alex de Minaur", "Holger Rune",
            "Ben Shelton", "Jakub Mensik", "Francisco Cerundolo", "Daniil Medvedev", "Felix Auger-Aliassime",
            "Taylor Fritz", "Andrey Rublev", "Stefanos Tsitsipas", "Rafael Nadal", "Hubert Hurkacz",
            "Sebastian Korda", "Grigor Dimitrov", "Frances Tiafoe", "Lorenzo Sonego", "Karen Khachanov",
            "Nicolas Jarry", "Cameron Norrie", "Ugo Humbert", "Arthur Fils", "Alexander Bublik",
            "Jan-Lennard Struff", "Matteo Berrettini", "Tomas Machac", "Sebastian Baez", "Alejandro Tabilo",
            "Flavio Cobolli", "Francisco Cerundolo", "Adrian Mannarino", "Mariano Navone", "Jordan Thompson",
            "Giovanni Mpetshi Perricard", "Alexei Popyrin", "Brandon Nakashima", "Jiri Lehecka", "Pedro Martinez",
            "Nuno Borges", "Matteo Arnaldi", "Luciano Darderi", "Zhang Yifan", "Tallon Griekspoor",
            "Arthur Rinderknech", "Roberto Carballes Baena", "Christopher O'Connell", "Pavel Kotov", "Yoshihito Nishioka",
            "Daniel Evans", "Thanasi Kokkinakis", "Max Purcell", "Fabio Fognini", "Marin Cilic",
            "Andy Murray", "Stan Wawrinka", "Gael Monfils", "Richard Gasquet", "John Isner",
            "Milos Raonic", "David Goffin", "Roberto Bautista Agut", "Pablo Carreno Busta", "Albert Ramos-Vinolas",
            "Fernando Verdasco", "Philipp Kohlschreiber", "Benoit Paire", "Jo-Wilfried Tsonga", "Marcos Giron",
            "Mackenzie McDonald", "Jenson Brooksby", "Stefan Kozlov", "Michael Mmoh", "Denis Kudla",
            "Christopher Eubanks", "Emilio Nava", "Jeffrey John Wolf", "Aleksandar Kovacevic", "Learner Tien",
            "Alex Michelsen", "Sebastian Ofner", "Dominik Koepfer", "Yannick Hanfmann", "Daniel Altmaier",
            "Oscar Otte", "Peter Gojowczyk", "Henri Squire", "Maximilian Marterer", "Rudolf Molleker",
            "Cedrik-Marcel Stebe", "Mischa Zverev", "Dustin Brown", "Miomir Kecmanovic", "Laslo Djere",
            "Dusan Lajovic", "Filip Krajinovic", "Viktor Troicki", "Janko Tipsarevic", "Nenad Zimonjic",
            "Facundo Bagnis", "Guido Pella", "Leonardo Mayer", "Diego Schwartzman", "Juan Martin del Potro",
            "Horacio Zeballos", "Maximo Gonzalez", "Andres Molteni", "Renzo Olivo", "Nicolas Kicker",
            "Carlos Berlocq", "Marco Trungelliti", "Facundo Arguello", "Andrea Collarini", "Juan Ignacio Londero",
            "Pablo Cuevas", "Martin Cuevas", "Ariel Behar", "Marcel Felder", "Pablo Andujar",
            "Guillermo Garcia-Lopez", "Feliciano Lopez", "Marcel Granollers", "Roberto Bautista Agut", "Pablo Carreno Busta",
            "Albert Ramos-Vinolas", "Fernando Verdasco", "David Ferrer", "Nicolas Almagro", "Tommy Robredo",
            "Feliciano Lopez", "Guillermo Garcia-Lopez", "Marcel Granollers", "Marc Lopez", "Daniel Gimeno-Traver",
            "Ivan Navarro", "Pere Riba", "Oscar Hernandez", "Ruben Ramirez Hidalgo", "Fabio Fognini",
            "Lorenzo Sonego", "Matteo Berrettini", "Marco Cecchinato", "Andreas Seppi", "Thomas Fabbiano",
            "Stefano Travaglia", "Salvatore Caruso", "Gianluca Mager", "Lorenzo Musetti", "Flavio Cobolli",
            "Matteo Arnaldi", "Luciano Darderi", "Francesco Passaro", "Luca Nardi", "Giulio Zeppieri",
            "Samuel Vincent Ruggeri", "Raul Brancaccio", "Gianmarco Moroni", "Kei Nishikori", "Yoshihito Nishioka",
            "Taro Daniel", "Go Soeda", "Yuichi Sugita", "Yasutaka Uchiyama", "Kaichi Uchida",
            "Yosuke Watanuki", "Hiroki Moriya", "Yuta Shimizu", "Denis Shapovalov", "Felix Auger-Aliassime",
            "Milos Raonic", "Vasek Pospisil", "Peter Polansky", "Steven Diez", "Brayden Schnur",
            "Gabriel Diallo", "Liam Draxl", "Alexis Galarneau", "Nick Kyrgios", "Alex de Minaur",
            "Jordan Thompson", "John Millman", "Matthew Ebden", "James Duckworth", "Christopher O'Connell",
            "Alexei Popyrin", "Thanasi Kokkinakis", "Max Purcell", "Jason Kubler", "John-Patrick Smith",
            "Luke Saville", "Marc Polmans", "Andrew Harris", "Daniil Medvedev", "Andrey Rublev",
            "Karen Khachanov", "Aslan Karatsev", "Roman Safiullin", "Pavel Kotov", "Alexander Bublik",
            "Mikhail Kukushkin", "Alexander Shevchenko", "Evgeny Donskoy", "Hubert Hurkacz", "Kamil Majchrzak",
            "Kacper Zuk", "Maks Kasnikowski", "Daniel Michalski", "Casper Ruud", "Viktor Durasovic",
            "Christian Ruud", "Lukas Hellum Lilleengen", "Nicolai Budkov Kjaer", "Holger Rune", "Frederik Loechte Nielsen",
            "Mikael Torpegaard", "Christian Sigsgaard", "Arthur Fils", "Ugo Humbert", "Adrian Mannarino",
            "Gael Monfils", "Richard Gasquet", "Benoit Paire", "Jo-Wilfried Tsonga", "Lucas Pouille",
            "Pierre-Hugues Herbert", "Nicolas Mahut", "Alexander Zverev", "Jan-Lennard Struff", "Dominik Koepfer",
            "Yannick Hanfmann", "Daniel Altmaier", "Oscar Otte", "Peter Gojowczyk", "Henri Squire",
            "Maximilian Marterer", "Rudolf Molleker", "Cameron Norrie", "Jack Draper", "Dan Evans",
            "Andy Murray", "Neal Skupski", "Joe Salisbury", "Lloyd Glasspool", "Jonny O'Mara",
            "Ken Skupski", "Dom Inglot", "Taylor Fritz", "Tommy Paul", "Ben Shelton",
            "Frances Tiafoe", "Sebastian Korda", "Brandon Nakashima", "Marcos Giron", "Mackenzie McDonald",
            "Jenson Brooksby", "Stefan Kozlov", "Lorenzo Musetti", "Matteo Arnaldi", "Flavio Cobolli",
            "Luciano Darderi", "Francesco Passaro", "Luca Nardi", "Giulio Zeppieri", "Samuel Vincent Ruggeri",
            "Raul Brancaccio", "Gianmarco Moroni", "Jakub Mensik", "Jiri Lehecka", "Tomas Machac",
            "Adam Pavlasek", "Vit Kopriva", "Zizou Bergs", "David Goffin", "Ruben Bemelmans",
            "Kimmer Coppejans", "Michael Geerts"
          ],
          "wta_top_250": [
            "Aryna Sabalenka", "Coco Gauff", "Madison Keys", "Iga Swiatek", "Mirra Andreeva",
            "Jessica Pegula", "Jasmine Paolini", "Elena Rybakina", "Elina Svitolina", "Ekaterina Alexandrova",
            "Amanda Anisimova", "Emma Navarro", "Clara Tauson", "Jelena Ostapenko", "Zheng Qinwen",
            "Daria Kasatkina", "Danielle Collins", "Paula Badosa", "Diana Shnaider", "Donna Vekic",
            "Anna Kalinskaya", "Marta Kostyuk", "Beatriz Haddad Maia", "Katie Boulter", "Magdalena Frech",
            "Liudmila Samsonova", "Victoria Azarenka", "Yulia Putintseva", "Caroline Wozniacki", "Elise Mertens",
            "Linda Noskova", "Anastasia Pavlyuchenkova", "Leylah Fernandez", "Maria Sakkari", "Petra Kvitova",
            "Sloane Stephens", "Caroline Garcia", "Veronika Kudermetova", "Ons Jabeur", "Karolina Muchova",
            "Anastasia Potapova", "Naomi Osaka", "Sorana Cirstea", "Peyton Stearns", "Anna Blinkova",
            "Lulu Sun", "Kaia Kanepi", "Xinyu Wang", "Cristina Bucsa", "Yue Yuan",
            "Alycia Parks", "Barbora Krejcikova", "Emma Raducanu", "Marketa Vondrousova", "Karolina Pliskova",
            "Marie Bouzkova", "Sara Bejlek", "Brenda Fruhvirtova", "Linda Fruhvirtova", "Tereza Martincova",
            "Katerina Siniakova", "Lucie Hradecka", "Renata Voracova", "Kristyna Pliskova", "Denisa Allertova",
            "Simona Halep", "Sorana Cirstea", "Ana Bogdan", "Irina-Camelia Begu", "Jaqueline Cristian",
            "Patricia Maria Tig", "Gabriela Ruse", "Elena-Gabriela Ruse", "Monica Niculescu", "Raluca Olaru",
            "Belinda Bencic", "Jil Teichmann", "Viktorija Golubic", "Stefanie Voegele", "Timea Bacsinszky",
            "Martina Hingis", "Patty Schnyder", "Amra Sadikovic", "Ylena In-Albon", "Susan Bandecchi",
            "Anhelina Kalinina", "Elina Svitolina", "Marta Kostyuk", "Dayana Yastremska", "Katarina Zavatska",
            "Lesia Tsurenko", "Yuliya Starodubtseva", "Katarina Volodko", "Anastasiya Soboleva", "Valeriya Strakhova",
            "Anastasia Potapova", "Veronika Kudermetova", "Ekaterina Alexandrova", "Daria Kasatkina", "Liudmila Samsonova",
            "Anna Kalinskaya", "Anastasia Pavlyuchenkova", "Svetlana Kuznetsova", "Elena Vesnina", "Vera Zvonareva",
            "Maria Sharapova", "Dinara Safina", "Elena Dementieva", "Anna Chakvetadze", "Nadia Petrova",
            "Coco Gauff", "Jessica Pegula", "Madison Keys", "Danielle Collins", "Amanda Anisimova",
            "Sloane Stephens", "Sofia Kenin", "Jennifer Brady", "Alison Riske", "Shelby Rogers",
            "Bernarda Pera", "Lauren Davis", "CiCi Bellis", "Sachia Vickery", "Catherine McNally",
            "Iga Swiatek", "Agnieszka Radwanska", "Magda Linette", "Magdalena Frech", "Katarzyna Kawa",
            "Maja Chwalinska", "Weronika Falkowska", "Paula Kania-Chodun", "Urszula Radwanska", "Klaudia Jans-Ignacik",
            "Jasmine Paolini", "Martina Trevisan", "Camila Giorgi", "Elisabetta Cocciaretto", "Lucia Bronzetti",
            "Sara Errani", "Roberta Vinci", "Flavia Pennetta", "Francesca Schiavone", "Tathiana Garbin",
            "Aryna Sabalenka", "Victoria Azarenka", "Aliaksandra Sasnovich", "Olga Govortsova", "Vera Lapko",
            "Yuliya Hatouka", "Iryna Shymanovich", "Anastasiya Komardina", "Lidziya Marozava", "Darya Kustova",
            "Paula Badosa", "Carla Suarez Navarro", "Garbine Muguruza", "Sara Sorribes Tormo", "Nuria Parrizas Diaz",
            "Cristina Bucsa", "Rebeka Masarova", "Jessica Bouzas Maneiro", "Aliona Bolsova", "Lara Arruabarrena",
            "Clara Tauson", "Caroline Wozniacki", "Simona Waltert", "Johanna Larsson", "Rebecca Peterson",
            "Mirjam Bjorklund", "Caijsa Hennemann", "Lisa Zaar", "Jacqueline Cabaj Awad", "Draginja Vukovic",
            "Emma Raducanu", "Katie Boulter", "Harriet Dart", "Heather Watson", "Jodie Burrage",
            "Francesca Jones", "Lily Miyazaki", "Yuriko Miyazaki", "Katie Swan", "Sonay Kartal",
            "Donna Vekic", "Petra Martic", "Ana Konjuh", "Ajla Tomljanovic", "Jana Fett",
            "Tereza Mrdeza", "Lea Boskovic", "Tara Wurth", "Tena Lukas", "Iva Primorac",
            "Elise Mertens", "Greet Minnen", "Yanina Wickmayer", "Alison Van Uytvanck", "Kirsten Flipkens",
            "Kim Clijsters", "Justine Henin", "An-Sophie Mestach", "Ysaline Bonaventure", "Marie Benoit",
            "Leylah Fernandez", "Bianca Andreescu", "Eugenie Bouchard", "Rebecca Marino", "Francoise Abanda",
            "Katherine Sebov", "Carol Zhao", "Sharon Fichman", "Gabriela Dabrowski", "Aleksandra Wozniak",
            "Naomi Osaka", "Misaki Doi", "Nao Hibino", "Kurumi Nara", "Ayano Shimizu",
            "Moyuka Uchijima", "Ena Shibahara", "Yuki Naito", "Shuko Aoyama", "Eri Hozumi",
            "Elena Rybakina", "Yulia Putintseva", "Zarina Diyas", "Yaroslava Shvedova", "Galina Voskoboeva",
            "Sesil Karatantcheva", "Yuliya Beygelzimer", "Oksana Kalashnikova", "Anna Danilina", "Diyas Zarina",
            "Zheng Qinwen", "Xinyu Wang", "Yue Yuan", "Shuai Zhang", "Saisai Zheng",
            "Qiang Wang", "Shuai Peng", "Yafan Wang", "Lin Zhu", "Xiyu Wang",
            "Beatriz Haddad Maia", "Laura Pigossi", "Carolina Alves", "Luisa Stefani", "Gabriela Ce",
            "Ingrid Gamarra Martins", "Carolina Meligeni Alves", "Thaisa Grana Pedretti", "Teliana Pereira", "Paula Goncalves",
            "Lulu Sun", "Erin Routliffe", "Sachia Vickery", "Paige Mary Hourigan", "Jade Lewis",
            "Valentina Ivanov", "Emily Fanning", "Finley Christie", "Grete Arn", "Rosemary Kells",
            "Astra Sharma", "Daria Saville", "Ajla Tomljanovic", "Priscilla Hon", "Maddison Inglis",
            "Destanee Aiava", "Olivia Gadecki", "Kimberly Birrell", "Ellen Perez", "Storm Sanders",
            "Peyton Stearns", "Robin Montgomery", "Hailey Baptiste", "Katie Volynets", "Ashlyn Krueger",
            "Claire Liu", "Caroline Dolehide", "Usue Maitane Arconada", "Sophie Chang", "Reese Brantmeier"
          ],
          "last_updated": "TIMESTAMP_PLACEHOLDER",
          "total_players": 500,
          "atp_source": "fixed_2025",
          "wta_source": "fixed_2025",
          "version": "complete_500"
        }
        EOF
        
        # Substitui timestamp atual
        TIMESTAMP=$(date -Iseconds)
        sed -i "s/TIMESTAMP_PLACEHOLDER/$TIMESTAMP/g" current_rankings.json
        
        echo "✅ Rankings criados: 250 ATP + 250 WTA = 500 jogadores"
        echo "📅 Timestamp: $TIMESTAMP"
        
        # Verifica tamanho do arquivo
        wc -l current_rankings.json
        ls -lh current_rankings.json
    
    - name: Send notification
      run: |
        MESSAGE="📊 <b>Rankings 2025 Atualizados!</b>%0A%0A✅ 500 jogadores atuais%0A👨 ATP: 250 (TOP mundial)%0A👩 WTA: 250 (TOP mundial)%0A📅 Rankings de julho 2025%0A🎾 Bot 100%25 operacional"
        
        curl -s "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d "text=$MESSAGE" \
          -d "parse_mode=HTML"
        
        echo "✅ Notificação enviada"
    
    - name: Commit rankings
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        
        git add current_rankings.json
        git commit -m "📊 Update to 2025 current rankings (250+250)" || echo "No changes"
        git push || echo "No push needed"
        
        echo "✅ Rankings salvos no GitHub"
        echo "🎉 Processo concluído em $(date)"
